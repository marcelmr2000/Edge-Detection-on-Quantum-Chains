(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13358,        315]
NotebookOptionsPosition[     12877,        298]
NotebookOutlinePosition[     13273,        314]
CellTagsIndexPosition[     13230,        311]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Ntot", " ", "=", " ", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nb", " ", "=", " ", 
    RowBox[{"Ntot", " ", "-", " ", "n"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"angle", " ", "=", 
    RowBox[{"180", "\[Degree]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"n", "/", "2"}], ",", 
     RowBox[{"n", "/", "2"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"nb", "/", "2"}], ",", " ", 
      RowBox[{"nb", "/", "2"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P2Rot", " ", "=", " ", 
    RowBox[{"{", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"mp", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "nb"}], "/", "2"}]}], ",", " ", 
    RowBox[{"mp", "<=", " ", 
     RowBox[{"nb", "/", "2"}]}], ",", " ", 
    RowBox[{"mp", "++"}], ",", " ", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"P2Rot", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"WignerD", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"P2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"P2", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "mp"}], "}"}], ",", 
          "angle"}], "]"}], ",", 
        RowBox[{"P2", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "mp"}], "}"}]}], "]"}]}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coupled", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"\"\<Coeff\>\"", ",", " ", "\"\<J\>\"", ",", " ", "\"\<M\>\""}], 
     "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", " ", "=", "1"}], ",", 
     RowBox[{"i", "<=", " ", 
      RowBox[{"Length", "[", "P2Rot", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", " ", "=", " ", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"n", "-", "nb"}], ")"}], "/", "2"}], "]"}]}], ",", 
       RowBox[{"j", "<=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "nb"}], ")"}], "/", "2"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ClebschGordan", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"n", "/", "2"}], ",", 
              RowBox[{"n", "/", "2"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"P2Rot", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
              RowBox[{"P2Rot", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", 
              RowBox[{
               RowBox[{"n", "/", "2"}], "+", 
               RowBox[{"P2Rot", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "3"}], "]"}], "]"}]}]}], "}"}]}], "]"}], "!=",
           "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"Coupled", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"P2Rot", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
              RowBox[{"ClebschGordan", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"n", "/", "2"}], ",", 
                  RowBox[{"n", "/", "2"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"P2Rot", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
                  RowBox[{"P2Rot", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", 
                  RowBox[{
                   RowBox[{"n", "/", "2"}], "+", 
                   RowBox[{"P2Rot", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "3"}], "]"}], "]"}]}]}], "}"}]}], 
               "]"}]}], ",", "j", ",", 
             RowBox[{
              RowBox[{"n", "/", "2"}], "+", 
              RowBox[{"P2Rot", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "3"}], "]"}], "]"}]}]}], "}"}]}], "]"}], 
         ",", "Continue"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PJ", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", " ", 
      RowBox[{"Ntot", "/", "2"}]}], ",", 
     RowBox[{"j", ">=", "0"}], ",", 
     RowBox[{"j", " ", "=", " ", 
      RowBox[{"j", "-", "1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Pj", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", " ", "=", " ", "2"}], ",", 
         RowBox[{"i", "<=", 
          RowBox[{"Length", "[", "Coupled", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", " ", "==", " ", 
            RowBox[{"Coupled", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", " ", 
           RowBox[{"Pj", " ", "=", " ", 
            RowBox[{"Pj", "+", 
             RowBox[{
              RowBox[{"Coupled", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "^", "2"}]}]}], ",", 
           " ", "Continue"}], "]"}]}], "\[IndentingNewLine]", "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"PutAppend", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"N", "[", "j", "]"}], ",", 
            RowBox[{"N", "[", "Pj", "]"}]}], "}"}], ",", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\</Users/marcel/Desktop/TFG/Prob_Dist/N=\>\"", ",", 
            RowBox[{"ToString", "[", "Ntot", "]"}], ",", "\"\<,n=\>\"", ",", 
            RowBox[{"ToString", "[", "n", "]"}], ",", "\"\<,theta=\>\"", ",", 
            
            RowBox[{"ToString", "[", "angle", "]"}]}], "]"}]}], "]"}], "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"PJ", ",", "Pj"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", "PJ", "]"}]}], "Input",
 CellChangeTimes->{{3.867079090167033*^9, 3.867079217770214*^9}, {
   3.8670792784268303`*^9, 3.8670793274510803`*^9}, {3.867079358776482*^9, 
   3.8670794248413973`*^9}, {3.867079483337678*^9, 3.867079607254737*^9}, {
   3.8670796412358007`*^9, 3.867079903713785*^9}, {3.8670801166273413`*^9, 
   3.867080125537644*^9}, {3.867080292752656*^9, 3.8670807314810123`*^9}, {
   3.867081183409225*^9, 3.86708132206959*^9}, {3.8670816783681593`*^9, 
   3.86708182523004*^9}, 3.8671221052304487`*^9, {3.867122172542376*^9, 
   3.8671222245226*^9}, {3.867254744046626*^9, 3.8672547512385798`*^9}, {
   3.867254792111306*^9, 3.867254792907589*^9}, 3.8672555318771143`*^9, {
   3.867256200919457*^9, 3.867256214698393*^9}, {3.867257989758925*^9, 
   3.867257999205673*^9}, {3.8672581001068707`*^9, 3.867258100211666*^9}, {
   3.86725820277011*^9, 3.867258311721382*^9}, {3.867258356831485*^9, 
   3.867258357319935*^9}, {3.8672597711576157`*^9, 3.8672597713438053`*^9}, {
   3.867259917368826*^9, 3.8672599174282618`*^9}, {3.867260183181282*^9, 
   3.867260188460606*^9}, {3.867260376055846*^9, 3.8672604548229523`*^9}, {
   3.8672605727912703`*^9, 3.8672606054739656`*^9}, {3.867260642393429*^9, 
   3.867260670496344*^9}, {3.867260973462468*^9, 3.867261028939557*^9}, {
   3.867425417751512*^9, 3.8674254224145184`*^9}, {3.867425475186517*^9, 
   3.867425663789383*^9}, {3.8674264941923237`*^9, 3.867426600956058*^9}, {
   3.867692916838574*^9, 3.867693215642582*^9}, {3.867693355186679*^9, 
   3.867693360862903*^9}, {3.867693737552532*^9, 3.8676937623835077`*^9}, {
   3.867694211538569*^9, 3.8676942158529587`*^9}, {3.867694331660386*^9, 
   3.867694358430105*^9}, {3.867694428421434*^9, 3.867694450904522*^9}, {
   3.867694487538534*^9, 3.867694558630104*^9}, {3.867694632079892*^9, 
   3.867694669789692*^9}, {3.867694767815782*^9, 3.8676947830673428`*^9}, {
   3.86769482762751*^9, 3.867694898041106*^9}, {3.867695321157133*^9, 
   3.867695351836956*^9}, {3.867695624034835*^9, 3.867695649559493*^9}, {
   3.867924736910479*^9, 3.867924747919396*^9}, {3.868020521308099*^9, 
   3.86802052832136*^9}, {3.868020824813298*^9, 3.8680208602262793`*^9}, {
   3.8680208997917013`*^9, 3.868020966362052*^9}, {3.86802100250875*^9, 
   3.868021125918744*^9}, {3.868021290835614*^9, 3.86802148546933*^9}, {
   3.868590511791504*^9, 3.86859054134072*^9}, 3.8685905860580807`*^9, {
   3.868590656381445*^9, 3.868590679773657*^9}, {3.8685907431368933`*^9, 
   3.868590756976679*^9}, {3.868590814310213*^9, 3.8685908145985727`*^9}, {
   3.868590850301676*^9, 3.8685908503775387`*^9}, {3.868590888195003*^9, 
   3.868590888429577*^9}, {3.8685909365921297`*^9, 3.86859094154636*^9}, {
   3.868590979123489*^9, 3.868590982469446*^9}, {3.868591016609779*^9, 
   3.868591017734139*^9}, {3.8685910580779963`*^9, 3.868591058267754*^9}, {
   3.8685910945508823`*^9, 3.8685911263718367`*^9}, {3.868591176915501*^9, 
   3.8685911920503883`*^9}, {3.868591231834697*^9, 3.868591231881937*^9}, {
   3.868591299598217*^9, 3.868591299657879*^9}, {3.8685913389927063`*^9, 
   3.8685913392320967`*^9}, 3.868591925387376*^9, {3.868592013585704*^9, 
   3.868592013950316*^9}, 3.86859207441332*^9, {3.8685921142562637`*^9, 
   3.868592126834324*^9}, {3.8685922002743807`*^9, 3.868592200344413*^9}, {
   3.8685922515566607`*^9, 3.8685922516071987`*^9}, {3.868592981470016*^9, 
   3.868592981558077*^9}, 3.86859301340452*^9, 3.868593051276972*^9, {
   3.868593818406208*^9, 3.868593818941136*^9}, {3.86861013886397*^9, 
   3.868610142992732*^9}, {3.868610316392933*^9, 3.8686103164705963`*^9}, {
   3.8686104068865643`*^9, 3.868610407189863*^9}, {3.868610449003634*^9, 
   3.86861044930696*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"e9bf6e2d-c5ff-424b-8014-5023a58610aa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.000012899896800825593`", ",", "0.00024509803921568627`", ",", 
   "0.0021929824561403508`", ",", "0.012254901960784314`", ",", 
   "0.04779411764705882`", ",", "0.1375`", ",", "0.3`", ",", "0.5`", ",", 
   "0.`", ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8685905263323174`*^9, 3.8685905437424517`*^9}, 
   3.868590587420403*^9, {3.868590657574102*^9, 3.8685906807670813`*^9}, {
   3.868590751242765*^9, 3.868590757414639*^9}, 3.868590815730225*^9, 
   3.868590851272788*^9, 3.868590889633379*^9, {3.868590937776969*^9, 
   3.86859094209416*^9}, 3.8685909830416527`*^9, 3.868591018443474*^9, 
   3.8685910590027657`*^9, {3.8685910983484087`*^9, 3.868591119912634*^9}, {
   3.868591185471056*^9, 3.868591193276167*^9}, 3.868591232778879*^9, 
   3.868591300301488*^9, 3.868591339915185*^9, 3.868591927374899*^9, 
   3.8685920148920307`*^9, 3.868592076112791*^9, 3.868592127378124*^9, 
   3.868592201041617*^9, 3.868592253024283*^9, 3.8685929836277733`*^9, 
   3.868593014438081*^9, 3.868593051950828*^9, 3.868593820127071*^9, 
   3.868610146180723*^9, 3.8686102438524714`*^9, 3.8686103176502743`*^9, 
   3.868610409355253*^9, 3.8686104499688473`*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"de611d16-319a-4f46-a689-fd78a1a92e68"]
}, Open  ]]
},
WindowSize->{1280, 668},
WindowMargins->{{1, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.0 para Mac OS X x86 (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"15c5b9a8-c2e1-4288-aed3-b2b513280d3a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 10983, 251, 809, "Input",ExpressionUUID->"e9bf6e2d-c5ff-424b-8014-5023a58610aa"],
Cell[11566, 275, 1295, 20, 34, "Output",ExpressionUUID->"de611d16-319a-4f46-a689-fd78a1a92e68"]
}, Open  ]]
}
]
*)

